/*!
 * light-print v1.1.0
 * (c) 2020 xunmi
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LightPrint=t()}(this,(function(){"use strict";var e=function(e,t){return e.appendChild(t)},t=window.NodeFilter.SHOW_ELEMENT,n=function(e,n){return window.document.createNodeIterator(e,t,n)},o=function(e){if(e instanceof Node)return e;if("string"==typeof e){var t=window.document.querySelector(e);if(t)return t}},r=function(e,t,n,o){var r=function(i){n(i),e.removeEventListener(t,r,o)};e.addEventListener(t,r,o)},i=window&&window.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function u(e){try{d(o.next(e))}catch(e){i(e)}}function c(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,c)}d((o=o.apply(e,t||[])).next())}))},u=window&&window.__generator||function(e,t){var n,o,r,i,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(r=u.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){u.label=i[1];break}if(6===i[0]&&u.label<r[1]){u.label=r[1],r=i;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(i);break}r[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},c=function(e,t){var n,o,r,i;void 0===t&&(t=1),n=e.documentElement,o="zoom",r=t,n.style.setProperty(o,String(r),i)},d=function(t){return new Promise((function(n,o){var i=function(e){var t=window.document.createElement("iframe");t.setAttribute("style","position: absolute; height: 0; width: 0; visibility: hidden;");var n=null!=e?e:window.document.title;return t.setAttribute("srcdoc","<html><head><title>"+n+"</title></head></html>"),t}(t);e(window.document.body,i),r(i,"load",(function(){return n(i)})),r(i,"error",(function(){return o(new Error("Failed to load document"))}))}))},a=function(e){return new Promise((function(t,n){e.focus();var o=e.contentWindow;if(!o)return n(new Error("Not found window"));if(/msie|trident/i.test(window.navigator.userAgent))try{o.document.execCommand("print",!1)}catch(e){o.print()}else o.print();r(o,"afterprint",(function(){var n,r;t(),o.close(),null===(r=(n=e).parentNode)||void 0===r||r.removeChild(n)}))}))};return function(t,r){return void 0===r&&(r={}),i(void 0,void 0,void 0,(function(){var i,l,f,s;return u(this,(function(u){switch(u.label){case 0:if(!(i=o(t)))throw new Error("Invalid HTML element");return[4,d(r.documentTitle)];case 1:if(l=u.sent(),!(f=function(e){var t,n;return null!==(n=null===(t=e.contentWindow)||void 0===t?void 0:t.document)&&void 0!==n?n:e.contentDocument}(l)))throw new Error("Not found document");return c(f,r.zoom),r.mediaPrintStyle&&(w=r.mediaPrintStyle,(m=window.document.createElement("style")).innerHTML="@media print {"+w+"}",s=m,e(f.head,s)),e(f.body,function(e,t){return e.importNode(t,!0)}(f,i)),function(e,t){for(var o,r,i,u=n(t),c=n(e.body),d=c.nextNode();d;){d=c.nextNode();var a=u.nextNode();a&&d&&(o=d,r=a,i=void 0,i=window.getComputedStyle(r,null),o.setAttribute("style",i.cssText))}}(f,i),[4,a(l)];case 2:return u.sent(),[2]}var w,m}))}))}}));
