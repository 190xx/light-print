/*!
 * light-print v0.1.0
 * (c) 2020 xunmi
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).LightPrint=e()}(this,(function(){"use strict";const t=(t,e)=>t.appendChild(e),e=(t,e)=>{const o=window.getComputedStyle(e,null);t.setAttribute("style",o.cssText)};function o(t,e){return null!=t?t:e()}const n=window.NodeFilter.SHOW_ELEMENT,i=t=>{if((t=>t instanceof Node)(t))return t;if("string"==typeof t){const e=window.document.querySelector(t);if(e)return e}throw new Error("Invalid HTML element")},c=t=>new Promise((e,o)=>{t.focus();const n=t.contentWindow;if(!n)return o(new Error("Not found window"));if(-1!==window.navigator.userAgent.toLowerCase().indexOf("msie")||window.StyleMedia)try{n.document.execCommand("print",!1)}catch(t){n.print()}else n.print();n.onafterprint=()=>{var o;e(),n.close(),function(t){let e=void 0,o=t[0],n=1;for(;n<t.length;){const i=t[n],c=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(e=o,o=c(o)):"call"!==i&&"optionalCall"!==i||(o=c((...t)=>o.call(e,...t)),e=void 0)}}([o=t,"access",t=>t.parentNode,"optionalAccess",t=>t.removeChild,"call",t=>t(o)])}});return(r,d={})=>new Promise((l,s)=>{const a=i(r),u=(t=>{const{documentTitle:e}=t,n=window.document.createElement("iframe");n.setAttribute("style"," position: absolute; height: 0; width: 0; visibility: hidden;");const i=o(e,()=>window.document.title);return n.setAttribute("srcdoc",`<html><head><title>${i}</title></head></html>`),n})(d);t(window.document.body,u),u.addEventListener("load",()=>{const i=o(function(t){let e=void 0,o=t[0],n=1;for(;n<t.length;){const i=t[n],c=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(e=o,o=c(o)):"call"!==i&&"optionalCall"!==i||(o=c((...t)=>o.call(e,...t)),e=void 0)}return o}([u,"access",t=>t.contentWindow,"optionalAccess",t=>t.document]),()=>u.contentDocument);if(!i)return s(new Error("Not found document"));if(i.body.style.zoom=String(o(d.zoom,()=>1)),d.mediaPrintStyle){const e=(t=>{const e=window.document.createElement("style");return e.innerHTML=`@media print {${t}}`,e})(d.mediaPrintStyle);t(i.head,e)}var r;t(i.body,(r=a,i.importNode(r,!0))),((t,o)=>{e(t.body,window.document.body);const i=window.document.createNodeIterator(o,n),c=t.createNodeIterator(t.body,n);let r=c.nextNode();for(;r;){r=c.nextNode();const t=i.nextNode();t&&r&&e(r,t)}})(i,a),c(u).then(l).catch(s)})})}));
