/*!
 * light-print v1.0.1
 * (c) 2020 xunmi
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LightPrint=t()}(this,(function(){"use strict";const e=(e,t)=>e.appendChild(t),t=(e,t)=>{const o=window.getComputedStyle(t,null);e.setAttribute("style",o.cssText)};function o(e,t){return null!=e?e:t()}const n=window.NodeFilter.SHOW_ELEMENT,i=e=>{if((e=>e instanceof Node)(e))return e;if("string"==typeof e){const t=window.document.querySelector(e);if(t)return t}throw new Error("Invalid HTML element")},r=(e,t=1)=>{var o,n,i,r;o=e.documentElement,n="zoom",i=t,o.style.setProperty(n,String(i),r)},c=e=>new Promise((t,o)=>{e.focus();const n=e.contentWindow;if(!n)return o(new Error("Not found window"));if(-1!==window.navigator.userAgent.toLowerCase().indexOf("msie")||window.StyleMedia)try{n.document.execCommand("print",!1)}catch(e){n.print()}else n.print();n.onafterprint=()=>{var o;t(),n.close(),function(e){let t=void 0,o=e[0],n=1;for(;n<e.length;){const i=e[n],r=e[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(t=o,o=r(o)):"call"!==i&&"optionalCall"!==i||(o=r((...e)=>o.call(t,...e)),t=void 0)}}([o=e,"access",e=>e.parentNode,"optionalAccess",e=>e.removeChild,"call",e=>e(o)])}});return(d,l={})=>new Promise((s,a)=>{const u=i(d),m=(e=>{const{documentTitle:t}=e,n=window.document.createElement("iframe");n.setAttribute("style"," position: absolute; height: 0; width: 0; visibility: hidden;");const i=o(t,()=>window.document.title);return n.setAttribute("srcdoc",`<html><head><title>${i}</title></head></html>`),n})(l);e(window.document.body,m),m.addEventListener("load",()=>{const i=o(function(e){let t=void 0,o=e[0],n=1;for(;n<e.length;){const i=e[n],r=e[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(t=o,o=r(o)):"call"!==i&&"optionalCall"!==i||(o=r((...e)=>o.call(t,...e)),t=void 0)}return o}([m,"access",e=>e.contentWindow,"optionalAccess",e=>e.document]),()=>m.contentDocument);if(!i)return a(new Error("Not found document"));if(r(i,l.zoom),l.mediaPrintStyle){const t=(e=>{const t=window.document.createElement("style");return t.innerHTML=`@media print {${e}}`,t})(l.mediaPrintStyle);e(i.head,t)}var d;e(i.body,(d=u,i.importNode(d,!0))),((e,o)=>{t(e.body,window.document.body);const i=window.document.createNodeIterator(o,n),r=e.createNodeIterator(e.body,n);let c=r.nextNode();for(;c;){c=r.nextNode();const e=i.nextNode();e&&c&&t(c,e)}})(i,u),c(m).then(s).catch(a)})})}));
