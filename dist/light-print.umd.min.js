/*!
 * light-print v1.0.2
 * (c) 2020 xunmi
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).LightPrint=e()}(this,(function(){"use strict";function t(t){let e=void 0,n=t[0],o=1;for(;o<t.length;){const i=t[o],r=t[o+1];if(o+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(e=n,n=r(n)):"call"!==i&&"optionalCall"!==i||(n=r((...t)=>n.call(e,...t)),e=void 0)}return n}const e=(t,e)=>t.appendChild(e),n=window.NodeFilter.SHOW_ELEMENT,o=(t,e)=>window.document.createNodeIterator(t,n,e),i=(t,e)=>{const n=window.getComputedStyle(e,null);t.setAttribute("style",n.cssText)},r=t=>{if(t instanceof Node)return t;if("string"==typeof t){const e=window.document.querySelector(t);if(e)return e}},c=(t,e,n,o)=>{const i=r=>{n(r),t.removeEventListener(e,i,o)};t.addEventListener(e,i,o)};const d=(t,e=1)=>{var n,o,i,r;n=t.documentElement,o="zoom",i=e,n.style.setProperty(o,String(i),r)},s=t=>new Promise((n,o)=>{const i=(t=>{const e=window.document.createElement("iframe");e.setAttribute("style","position: absolute; height: 0; width: 0; visibility: hidden;");const n=(i=()=>window.document.title,null!=(o=t)?o:i());var o,i;return e.setAttribute("srcdoc",`<html><head><title>${n}</title></head></html>`),e})(t);e(window.document.body,i),c(i,"load",()=>n(i)),c(i,"error",()=>o(new Error("Failed to load document")))}),l=e=>new Promise((n,o)=>{e.focus();const i=e.contentWindow;if(!i)return o(new Error("Not found window"));if(/msie|trident/i.test(window.navigator.userAgent))try{i.document.execCommand("print",!1)}catch(t){i.print()}else i.print();c(i,"afterprint",()=>{var o;n(),i.close(),t([o=e,"access",t=>t.parentNode,"optionalAccess",t=>t.removeChild,"call",t=>t(o)])})});return async(n,c={})=>{const a=r(n);if(!a)throw new Error("Invalid HTML element");const u=await s(c.documentTitle),m=(f=t([w=u,"access",t=>t.contentWindow,"optionalAccess",t=>t.document]),p=()=>w.contentDocument,null!=f?f:p());var w,f,p,y;if(!m)throw new Error("Not found document");if(d(m,c.zoom),c.mediaPrintStyle){const t=(t=>{const e=window.document.createElement("style");return e.innerHTML=`@media print {${t}}`,e})(c.mediaPrintStyle);e(m.head,t)}e(m.body,(y=a,m.importNode(y,!0))),((t,e)=>{const n=o(e),r=o(t.body);let c=r.nextNode();for(;c;){c=r.nextNode();const t=n.nextNode();t&&c&&i(c,t)}})(m,a),await l(u)}}));
