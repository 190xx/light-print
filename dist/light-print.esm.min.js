/*!
 * light-print v1.0.2
 * (c) 2020 xunmi
 * Released under the MIT License.
 */
function t(t){let e=void 0,o=t[0],n=1;for(;n<t.length;){const i=t[n],r=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(e=o,o=r(o)):"call"!==i&&"optionalCall"!==i||(o=r((...t)=>o.call(e,...t)),e=void 0)}return o}const e=(t,e)=>t.appendChild(e),o=window.NodeFilter.SHOW_ELEMENT,n=(t,e)=>window.document.createNodeIterator(t,o,e),i=(t,e)=>{const o=window.getComputedStyle(e,null);t.setAttribute("style",o.cssText)},r=t=>{if(t instanceof Node)return t;if("string"==typeof t){const e=window.document.querySelector(t);if(e)return e}},c=(t,e,o,n)=>{const i=r=>{o(r),t.removeEventListener(e,i,n)};t.addEventListener(e,i,n)};const d=(t,e=1)=>{var o,n,i,r;o=t.documentElement,n="zoom",i=e,o.style.setProperty(n,String(i),r)},l=t=>new Promise((o,n)=>{const i=(t=>{const e=window.document.createElement("iframe");e.setAttribute("style","position: absolute; height: 0; width: 0; visibility: hidden;");const o=(i=()=>window.document.title,null!=(n=t)?n:i());var n,i;return e.setAttribute("srcdoc",`<html><head><title>${o}</title></head></html>`),e})(t);e(window.document.body,i),c(i,"load",()=>o(i)),c(i,"error",()=>n(new Error("Failed to load document")))}),s=e=>new Promise((o,n)=>{e.focus();const i=e.contentWindow;if(!i)return n(new Error("Not found window"));if(/msie|trident/i.test(window.navigator.userAgent))try{i.document.execCommand("print",!1)}catch(t){i.print()}else i.print();c(i,"afterprint",()=>{var n;o(),i.close(),t([n=e,"access",t=>t.parentNode,"optionalAccess",t=>t.removeChild,"call",t=>t(n)])})});export default async(o,c={})=>{const a=r(o);if(!a)throw new Error("Invalid HTML element");const u=await l(c.documentTitle),m=(f=t([w=u,"access",t=>t.contentWindow,"optionalAccess",t=>t.document]),p=()=>w.contentDocument,null!=f?f:p());var w,f,p,y;if(!m)throw new Error("Not found document");if(d(m,c.zoom),c.mediaPrintStyle){const t=(t=>{const e=window.document.createElement("style");return e.innerHTML=`@media print {${t}}`,e})(c.mediaPrintStyle);e(m.head,t)}e(m.body,(y=a,m.importNode(y,!0))),((t,e)=>{const o=n(e),r=n(t.body);let c=r.nextNode();for(;c;){c=r.nextNode();const t=o.nextNode();t&&c&&i(c,t)}})(m,a),await s(u)};
