/*!
 * light-print v1.0.1
 * (c) 2020 xunmi
 * Released under the MIT License.
 */
const t=(t,e)=>t.appendChild(e),e=(t,e)=>{const o=window.getComputedStyle(e,null);t.setAttribute("style",o.cssText)};function o(t,e){return null!=t?t:e()}const n=window.NodeFilter.SHOW_ELEMENT,i=t=>{if((t=>t instanceof Node)(t))return t;if("string"==typeof t){const e=window.document.querySelector(t);if(e)return e}throw new Error("Invalid HTML element")},r=(t,e=1)=>{var o,n,i,r;o=t.documentElement,n="zoom",i=e,o.style.setProperty(n,String(i),r)},c=t=>new Promise((e,o)=>{t.focus();const n=t.contentWindow;if(!n)return o(new Error("Not found window"));if(-1!==window.navigator.userAgent.toLowerCase().indexOf("msie")||window.StyleMedia)try{n.document.execCommand("print",!1)}catch(t){n.print()}else n.print();n.onafterprint=()=>{var o;e(),n.close(),function(t){let e=void 0,o=t[0],n=1;for(;n<t.length;){const i=t[n],r=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(e=o,o=r(o)):"call"!==i&&"optionalCall"!==i||(o=r((...t)=>o.call(e,...t)),e=void 0)}}([o=t,"access",t=>t.parentNode,"optionalAccess",t=>t.removeChild,"call",t=>t(o)])}});export default(l,d={})=>new Promise((s,a)=>{const u=i(l),w=(t=>{const{documentTitle:e}=t,n=window.document.createElement("iframe");n.setAttribute("style"," position: absolute; height: 0; width: 0; visibility: hidden;");const i=o(e,()=>window.document.title);return n.setAttribute("srcdoc",`<html><head><title>${i}</title></head></html>`),n})(d);t(window.document.body,w),w.addEventListener("load",()=>{const i=o(function(t){let e=void 0,o=t[0],n=1;for(;n<t.length;){const i=t[n],r=t[n+1];if(n+=2,("optionalAccess"===i||"optionalCall"===i)&&null==o)return;"access"===i||"optionalAccess"===i?(e=o,o=r(o)):"call"!==i&&"optionalCall"!==i||(o=r((...t)=>o.call(e,...t)),e=void 0)}return o}([w,"access",t=>t.contentWindow,"optionalAccess",t=>t.document]),()=>w.contentDocument);if(!i)return a(new Error("Not found document"));if(r(i,d.zoom),d.mediaPrintStyle){const e=(t=>{const e=window.document.createElement("style");return e.innerHTML=`@media print {${t}}`,e})(d.mediaPrintStyle);t(i.head,e)}var l;t(i.body,(l=u,i.importNode(l,!0))),((t,o)=>{e(t.body,window.document.body);const i=window.document.createNodeIterator(o,n),r=t.createNodeIterator(t.body,n);let c=r.nextNode();for(;c;){c=r.nextNode();const t=i.nextNode();t&&c&&e(c,t)}})(i,u),c(w).then(s).catch(a)})});
